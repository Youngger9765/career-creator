# 週報 - 2025年10月7日

## 本週完成：第2個月核心功能與 UX 優化

### 測試環境

- **Staging URL**: <https://career-creator-frontend-staging-990202338378.asia-east1.run.app>

---

## 👥 用戶回饋整合（美荷測試）

### ✅ 本週已處理（6/6 完成）

- **#6 牌卡排序功能** 🔴 P0 - ✅ 已完成
  - 問題：「希望右邊選的牌能夠重新排序」
  - 解決：右側區域支援拖曳重新排序，所有遊戲模式全面支援

- **#5 牌卡縮小/展開視圖** 🟡 P1 - ✅ 已完成
  - 問題：「希望右邊選的牌可以縮小一點，這樣比較好一眼看到全部」
  - 解決：新增 List/Card 雙視圖模式，一鍵切換

- **#3 調整選擇牌卡數量** 🟡 P1 - ✅ 已完成
  - 問題：「希望可以調整選擇牌卡的數量」
  - 解決：內聯編輯器（上限: [15] 張），Enter 確認或失焦保存

- **#2 刪除諮詢室功能** 🟡 P1 - ✅ 已完成
  - 問題：「希望可以刪除諮詢室」
  - 解決：Dashboard 和客戶管理添加刪除按鈕，軟刪除機制

- **#4 上傳JD顯示太小** 🟢 P2 - ✅ 已優化
  - 問題：「上傳的JD顯示太小了」
  - 解決：改善職位拆解遊戲的 JD 預覽 UX

- **#1 返回鍵誤觸問題** 🔴 P0 - ✅ 已完成
  - 問題：「不小心按返回就退出諮詢室了」
  - 解決：改用明確的「退出諮詢室」按鈕 + 確認對話框

### 🔮 未來規劃

- **#7 時間線玩法** 🟢 P2
  - 說明：新增「現在 vs 理想未來」對比視圖

---

## 📋 PM 回饋待討論事項（週會議題）

### 🔴 P0 - 嚴重 Bug

**#2 客戶狀態切換後，諮詢室記錄消失**

- **問題描述**：
  1. 進入「客戶管理」頁面
  2. 點擊 ✏️ 編輯客戶
  3. 將狀態從「活躍 (Active)」改為「暫停 (Pending)」
  4. 再改回「活躍 (Active)」
  5. 結果：過去的諮詢室記錄全部消失

- **影響**：資料遺失問題，用戶無法查看歷史諮詢記錄

- **待確認**：
  - [ ] 是資料庫查詢過濾問題？
  - [ ] 是狀態切換觸發了清理邏輯？
  - [ ] 是 RLS 權限設定問題？

- **建議處理**：立即修復

---

### 🟡 P1 - 設計決策需討論

**#3 客戶狀態分類優化**

- **目前狀態**：
  - Active（活躍）
  - Pending（待處理）
  - Archived（已封存）

- **PM 建議改為**：
  - Not started（未開始）- 新客戶，還沒開始諮詢
  - In Progress（進行中）- 正在進行諮詢
  - Paused（暫停）- 暫時中斷，未來可能繼續
  - Completed（已完成）- 諮詢結束

- **建議的狀態流轉**：
  ```
  Not started → In Progress → Paused → In Progress → Completed
                ↓
                Completed（也可以直接結束）
  ```

- **待討論**：
  - [ ] 是否採用新的狀態分類？
  - [ ] 狀態流轉規則如何定義？
  - [ ] 如何處理現有資料的遷移？
  - [ ] 是否需要限制某些狀態轉換？

---

### 🟢 P2 - 新功能規劃

**#1 諮詢室版本管理功能**

- **PM 觀察**：
  - 同一個客戶在不同諮詢室內的卡牌結果不會同步
  - 每個諮詢室是獨立的

- **PM 建議**：
  - 既然每次諮詢可能有不同結果（例如：3/1 vs 3/15）
  - 可以做成「版本管理」功能
  - 讓諮詢師儲存多個版本，方便對照不同時期的結果
  - 例如：「小明的職業興趣測驗 - 2025/03/01 版本」vs「小明的職業興趣測驗 - 2025/03/15 版本」

- **待討論**：
  - [ ] 目前設計：每個諮詢室是否確實是獨立的？
  - [ ] 是否需要版本管理功能？
  - [ ] 如果需要，版本管理的具體需求？
    - 版本命名方式？
    - 版本比對功能？
    - 版本數量限制？
  - [ ] 還是維持現狀（每個諮詢室獨立）？

---

## 📊 本週開發成果總覽

### ✅ 核心功能完成

#### 1. **諮詢師筆記系統** ✅ (PRD 第2個月核心需求)

- ✅ 抽屜式筆記面板設計
- ✅ 即時儲存功能
- ✅ 與諮詢室整合
- ✅ UX 優化（開關流暢、內容持久化）

**PRD 對應**: 第2個月 > 諮詢師筆記功能 > 選項A（手動筆記系統）

#### 2. **牌卡重新排序功能** ✅ (用戶回饋 P0 #6)

- ✅ 右側區域支援拖曳重新排序
- ✅ 所有遊戲模式全面支援
- ✅ 即時同步排序狀態
- ✅ 符合諮詢流程需求（先選再排序）

**用戶回饋**: 「希望右邊選的牌能夠重新排序」

#### 3. **雙視圖模式** ✅ (用戶回饋 P1 #5)

- ✅ List 模式（緊湊視圖）- 僅顯示卡片標題
- ✅ Card 模式（完整卡片）- 顯示完整內容
- ✅ 一鍵切換視圖
- ✅ 解決右側區域擁擠問題

**用戶回饋**: 「希望右邊選的牌可以縮小一點，這樣比較好一眼看到全部」

#### 4. **房間退出 UX 改善** ✅ (用戶回饋 P0 #1)

- ✅ 改用明確的「退出諮詢室」按鈕（取代返回鍵）
- ✅ 添加確認對話框防止意外退出
- ✅ 僅在遊戲選擇模式顯示退出按鈕（遊戲中隱藏）
- ✅ 同步狀態顯示優化（移至 Header）

**用戶回饋**: 「不小心按返回就退出諮詢室了」

---

### 🏗️ 基礎設施與 DevOps

#### 5. **CI/CD 自動化完善** ✅

- ✅ 自動 Database migrations
- ✅ IPv4 相容性修復
- ✅ 連線池問題解決
- ✅ 多次部署流程優化
- ✅ 錯誤處理與 debug logging

**影響**: 大幅提升部署穩定性與效率

---

### 🎨 UI/UX 改進

#### 6. **Dashboard 重設計** ✅

- ✅ 可收合側邊欄
- ✅ 客戶管理介面改版
- ✅ 響應式佈局優化

#### 7. **JD 預覽優化** ✅ (用戶回饋 P2 #4)

- ✅ 改善職位拆解遊戲的 JD 預覽 UX
- ✅ 更好的閱讀體驗

**用戶回饋**: 「上傳的JD顯示太小了」

#### 8. **刪除諮詢室功能（軟刪除）** ✅ (用戶回饋 P1 #2)

- ✅ Dashboard 房間列表刪除按鈕
- ✅ 客戶管理中的房間刪除功能
- ✅ 軟刪除機制（is_active=false）
- ✅ 整合 DeleteRoomDialog
- ✅ Overview tab 移除（簡化介面）

**用戶回饋**: 「希望可以刪除諮詢室」

#### 9. **調整選擇牌卡數量** ✅ (用戶回饋 P1 #3)

- ✅ 簡化的數量編輯器 UX
- ✅ 內聯編輯（上限: [15] 張）
- ✅ Enter 確認或失焦保存
- ✅ 僅房主可編輯
- ✅ 即時更新計數器

**用戶回饋**: 「希望可以調整選擇牌卡的數量」


---

## 📈 PRD 第2個月進度更新

### 完成項目 ✅

- **牌卡視覺體驗優化** - Week 5 完成
- **諮詢師筆記功能（選項A）** - Week 7 完成
- **CI/CD 自動化完善** - Week 7 完成
- **Dashboard UI 重設計** - Week 7 完成

### 待完成項目 ❌

- **牌卡狀態持久化（Event Sourcing）** - 🔴 P0 - 預計 Week 8-9
- **真實牌卡內容上架** - 🟡 P1 - 預計 Week 9-10
- **房間狀態恢復功能** - 🟡 P1 - 預計 Week 10

---

## 🎯 下週重點（Week 8: 2025-10-08 ~ 10-14）

### 優先級 P0

1. **開始 Event Sourcing 架構**
   - 設計 card_events 資料表
   - 實作基礎事件記錄
   - 牌卡操作持久化

### 優先級 P1

2. **開始真實牌卡內容上架**
   - 牌卡圖片資源上傳
   - 文案細節調整優化
   - 內容管理系統建置

### 技術債務

3. **修復現有測試套件**
   - 更新快照測試
   - 新功能測試覆蓋
   - CI/CD 測試自動化

---

## 📌 已知問題

1. **牌卡內容尚未完整上架** - 等待內容提供
2. **Event Sourcing 未實作** - 下週開始設計

---

## 🚀 部署狀態

- ✅ Staging 環境穩定運行
- ✅ CI/CD 自動化部署正常
- ✅ Database migrations 自動執行

---

## 📝 結論

本週完成了第2個月的核心功能（諮詢師筆記），並且**100% 完成所有已規劃的用戶回饋**（6/6 項），包括所有 P0/P1/P2 優先級問題。特別是牌卡排序功能、雙視圖模式、退出確認對話框、數量調整和刪除功能，大幅提升了諮詢師的使用體驗。

**下週目標**：開始 Event Sourcing 架構實作，為牌卡狀態持久化打好基礎，並規劃真實牌卡內容上架流程。

---

## 測試建議

請使用 Chrome/Edge 最新版本測試以下新功能：

1. ✅ 諮詢師筆記抽屜（右上角圖示）
2. ✅ 牌卡重新排序（拖曳已選擇的卡片）
3. ✅ 視圖模式切換（List / Card 按鈕）
4. ✅ 牌卡數量調整（點擊數字編輯，如「上限: [15] 張」）
5. ✅ 刪除諮詢室（Dashboard 中的垃圾桶圖示）
6. ✅ 退出諮詢室確認對話框（點擊「退出諮詢室」按鈕）
7. ✅ Dashboard 可收合側邊欄
8. ✅ JD 預覽優化（職位拆解遊戲）

---

**報告產生時間**: 2025-10-07
**涵蓋期間**: 2025-09-30 ~ 2025-10-07 (Week 7)
**下次更新**: 2025-10-14
